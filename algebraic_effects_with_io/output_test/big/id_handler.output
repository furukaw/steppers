Step 0:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle ((fun x -> print(x; y. y)) "What is your forename?"; do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname)))
Step 1:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (print("What is your forename?"; y. y); do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname)))
Step 1:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (print("What is your forename?"; y. y); do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname)))
Step 2:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle print("What is your forename?"; y. (y; do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))))
Step 2:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle print("What is your forename?"; y. (y; do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))))
Step 3:  print("What is your forename?"; y. with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (y; do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))))
Step 3:  print("What is your forename?"; y. with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (y; do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))))
Step 4:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle ((); do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname)))
  Output:  What is your forename?

Step 4:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle ((); do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname)))
  Output:  What is your forename?
Step 5:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))
  Output:  What is your forename?

Step 5:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- (fun x -> read(x; y. y)) () in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))
  Output:  What is your forename?
Step 6:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- read((); y. y) in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))
  Output:  What is your forename?

Step 6:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- read((); y. y) in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))
  Output:  What is your forename?
Step 7:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle read((); y. do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname)))
  Output:  What is your forename?

Step 7:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle read((); y. do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname)))
  Output:  What is your forename?
Step 8:  do result <- (fun x -> read(x; y. y)) () in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) result
  Output:  What is your forename?

Step 8:  do result <- (fun x -> read(x; y. y)) () in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) result
  Output:  What is your forename?
Step 9:  do result <- read((); y. y) in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) result
  Output:  What is your forename?

Step 9:  do result <- read((); y. y) in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) result
  Output:  What is your forename?
Step 10:  read((); y. do result <- y in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) result)
  Output:  What is your forename?

new input> Kenichi

Step 10:  read((); y. do result <- y in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) result)
  Output:  What is your forename?
Step 11:  do result <- "Kenichi" in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) result
  Input:   Kenichi
  Output:  What is your forename?

Step 11:  do result <- "Kenichi" in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) result
  Input:   Kenichi
  Output:  What is your forename?
Step 12:  (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) "Kenichi"
  Input:   Kenichi
  Output:  What is your forename?

Step 12:  (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- y in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))) "Kenichi"
  Input:   Kenichi
  Output:  What is your forename?
Step 13:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- "Kenichi" in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))
  Input:   Kenichi
  Output:  What is your forename?

Step 13:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do forename <- "Kenichi" in ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join forename surname))
  Input:   Kenichi
  Output:  What is your forename?
Step 14:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname))
  Input:   Kenichi
  Output:  What is your forename?

Step 14:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle ((fun x -> print(x; y. y)) "What is your surname?"; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname))
  Input:   Kenichi
  Output:  What is your forename?
Step 15:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (print("What is your surname?"; y. y); do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname))
  Input:   Kenichi
  Output:  What is your forename?

Step 15:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (print("What is your surname?"; y. y); do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname))
  Input:   Kenichi
  Output:  What is your forename?
Step 16:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle print("What is your surname?"; y. (y; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname)))
  Input:   Kenichi
  Output:  What is your forename?

Step 16:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle print("What is your surname?"; y. (y; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname)))
  Input:   Kenichi
  Output:  What is your forename?
Step 17:  print("What is your surname?"; y. with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (y; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname)))
  Input:   Kenichi
  Output:  What is your forename?

Step 17:  print("What is your surname?"; y. with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (y; do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname)))
  Input:   Kenichi
  Output:  What is your forename?
Step 18:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle ((); do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname))
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?

Step 18:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle ((); do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname))
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?
Step 19:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname)
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?

Step 19:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- (fun x -> read(x; y. y)) () in (fun x -> print(x; y. y)) (join "Kenichi" surname)
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?
Step 20:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- read((); y. y) in (fun x -> print(x; y. y)) (join "Kenichi" surname)
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?

Step 20:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- read((); y. y) in (fun x -> print(x; y. y)) (join "Kenichi" surname)
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?
Step 21:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle read((); y. do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname))
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?

Step 21:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle read((); y. do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname))
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?
Step 22:  do result <- (fun x -> read(x; y. y)) () in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) result
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?

Step 22:  do result <- (fun x -> read(x; y. y)) () in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) result
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?
Step 23:  do result <- read((); y. y) in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) result
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?

Step 23:  do result <- read((); y. y) in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) result
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?
Step 24:  read((); y. do result <- y in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) result)
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?

new input> Asai

Step 24:  read((); y. do result <- y in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) result)
  Input:   Kenichi
  Output:  What is your forename?
           What is your surname?
Step 25:  do result <- "Asai" in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) result
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?

Step 25:  do result <- "Asai" in (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) result
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
Step 26:  (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) "Asai"
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?

Step 26:  (fun y -> with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- y in (fun x -> print(x; y. y)) (join "Kenichi" surname)) "Asai"
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
Step 27:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- "Asai" in (fun x -> print(x; y. y)) (join "Kenichi" surname)
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?

Step 27:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle do surname <- "Asai" in (fun x -> print(x; y. y)) (join "Kenichi" surname)
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
Step 28:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (fun x -> print(x; y. y)) (join "Kenichi" "Asai")
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?

Step 28:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (fun x -> print(x; y. y)) (join "Kenichi" "Asai")
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
Step 29:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (fun x -> print(x; y. y)) "Kenichi Asai"
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?

Step 29:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle (fun x -> print(x; y. y)) "Kenichi Asai"
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
Step 30:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle print("Kenichi Asai"; y. y)
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?

Step 30:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle print("Kenichi Asai"; y. y)
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
Step 31:  print("Kenichi Asai"; y. with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle y)
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?

Step 31:  print("Kenichi Asai"; y. with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle y)
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
Step 32:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle ()
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
           Kenichi Asai

Step 32:  with handler {read(s; k) -> do result <- (fun x -> read(x; y. y)) s in k result} handle ()
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
           Kenichi Asai
Step 33:  ()
  Input:   Kenichi
           Asai
  Output:  What is your forename?
           What is your surname?
           Kenichi Asai

Result:  ()
